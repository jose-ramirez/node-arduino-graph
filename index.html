<!DOCTYPE html5>
<html>
  <head>
    <title>
      Arduino com node.js
    </title>
    <script src="Chart.js"></script>
    <script src="socket.io-1.4.5.js"></script>
  </head>
  <body>
    <div width="400" height="400">
        <canvas id="myChart"></canvas>
    </div>
    <script>
      var contador = 0;
      var ctx = document.getElementById("myChart").getContext("2d");
      var dados = {
        type: 'line',
        data: {
          labels: [],
          datasets: [
            {
              label: "Gr√°fico Arduino",
      				fillColor: "rgba(220,220,220,0.2)",
      				strokeColor: "rgba(220,220,220,1)",
      				pointColor: "rgba(220,220,220,1)",
      				pointStrokeColor: "#fff",
      				pointHighlightFill: "#fff",
      				pointHighlightStroke: "rgba(220,220,220,1)",
              data: []
            }
          ]
        }
      };
      var myLineChart = new Chart(ctx, dados);

      var socket = io();
      socket.on("dadosArduino", function(dado){
        var dadosArray = myLineChart.data.datasets[0].data;
        var labelsArray = myLineChart.data.labels;

        
        if(dadosArray.length == 5){
          labelsArray.splice(0,1);
          dadosArray.splice(0,1);
        }

        labelsArray.push(dado.lbl);
        dadosArray.push(dado.valor);

        myLineChart.update();
        console.log(dadosArray.length);
      });
    </script>
  </body>
</html>
